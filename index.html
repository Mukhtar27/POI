<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Geocoder - POI Finder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header-icon {
            width: 60px;
            height: 60px;
            background: #4CAF50;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            font-size: 24px;
            color: white;
        }

        .header h1 {
            color: #333;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .header .subtitle {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .header .description {
            color: #888;
            font-size: 12px;
            font-style: italic;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: flex;
            align-items: center;
            color: #555;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-label::before {
            content: '';
            width: 16px;
            height: 16px;
            margin-right: 8px;
            border-radius: 3px;
        }

        .form-label.location::before {
            background: #FF6B6B;
        }

        .form-label.radius::before {
            background: #4ECDC4;
        }

        .form-label.category::before {
            background: #45B7D1;
        }

        .form-label.api-key::before {
            background: #FFA726;
        }

        .input-wrapper {
            position: relative;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: white;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .toggle-buttons {
            display: flex;
            background: #f5f5f5;
            border-radius: 8px;
            padding: 4px;
            margin-bottom: 15px;
        }

        .toggle-btn {
            flex: 1;
            padding: 8px 16px;
            border: none;
            background: transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
            font-weight: 600;
        }

        .toggle-btn.active {
            background: white;
            color: #667eea;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .input-group {
            display: flex;
            gap: 10px;
        }

        .input-group .form-input {
            flex: 1;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #4CAF50 0%, #45A049 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(76, 175, 80, 0.3);
        }

        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loading {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid transparent;
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results {
            margin-top: 30px;
            display: none;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .results-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .results-count {
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
        }

        .poi-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            background: white;
        }

        .poi-item {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            transition: background 0.2s ease;
        }

        .poi-item:hover {
            background: #f8f9ff;
        }

        .poi-item:last-child {
            border-bottom: none;
        }

        .poi-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .poi-address {
            color: #666;
            font-size: 13px;
            margin-bottom: 5px;
        }

        .poi-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .poi-rating {
            display: flex;
            align-items: center;
            gap: 5px;
            color: #FFA726;
            font-size: 12px;
        }

        .poi-distance {
            color: #888;
            font-size: 12px;
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #c62828;
            display: none;
        }

        .city-input {
            display: none;
        }

        .coords-input {
            display: block;
        }

        @media (max-width: 480px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            .input-group {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-icon">üåç</div>
            <h1>Global Geocoder</h1>
            <div class="subtitle">Find Points of Interest ‚Üí Anywhere</div>
            <div class="description">Discover businesses and places within your specified radius</div>
        </div>

        <form id="geocoderForm">
            <div class="form-group">
                <label class="form-label api-key">üîë Google Maps API Key</label>
                <input type="password" class="form-input" id="apiKey" placeholder="Enter your Google Maps API key" required>
            </div>

            <div class="form-group">
                <label class="form-label location">üìç Location</label>
                <div class="toggle-buttons">
                    <button type="button" class="toggle-btn active" onclick="toggleLocationInput('coords')">Coordinates</button>
                    <button type="button" class="toggle-btn" onclick="toggleLocationInput('city')">City Name</button>
                </div>
                
                <div class="coords-input" id="coordsInput">
                    <div class="input-group">
                        <input type="number" class="form-input" id="latitude" placeholder="Latitude" step="any" required>
                        <input type="number" class="form-input" id="longitude" placeholder="Longitude" step="any" required>
                    </div>
                </div>
                
                <div class="city-input" id="cityInput">
                    <input type="text" class="form-input" id="cityName" placeholder="Enter city name (e.g., New York, NY)">
                </div>
            </div>

            <div class="form-group">
                <label class="form-label radius">üìè Search Radius (meters)</label>
                <input type="number" class="form-input" id="radius" placeholder="500" min="1" max="50000" value="500" required>
            </div>

            <div class="form-group">
                <label class="form-label category">üè¢ Business Category</label>
                <select class="form-select" id="category" required>
                    <option value="">Select a category</option>
                    <option value="accounting">Accounting</option>
                    <option value="airport">Airport</option>
                    <option value="amusement_park">Amusement Park</option>
                    <option value="aquarium">Aquarium</option>
                    <option value="art_gallery">Art Gallery</option>
                    <option value="atm">ATM</option>
                    <option value="bakery">Bakery</option>
                    <option value="bank">Bank</option>
                    <option value="bar">Bar</option>
                    <option value="beauty_salon">Beauty Salon</option>
                    <option value="bicycle_store">Bicycle Store</option>
                    <option value="book_store">Book Store</option>
                    <option value="bowling_alley">Bowling Alley</option>
                    <option value="bus_station">Bus Station</option>
                    <option value="cafe">Cafe</option>
                    <option value="campground">Campground</option>
                    <option value="car_dealer">Car Dealer</option>
                    <option value="car_rental">Car Rental</option>
                    <option value="car_repair">Car Repair</option>
                    <option value="car_wash">Car Wash</option>
                    <option value="casino">Casino</option>
                    <option value="cemetery">Cemetery</option>
                    <option value="church">Church</option>
                    <option value="city_hall">City Hall</option>
                    <option value="clothing_store">Clothing Store</option>
                    <option value="convenience_store">Convenience Store</option>
                    <option value="courthouse">Courthouse</option>
                    <option value="dentist">Dentist</option>
                    <option value="department_store">Department Store</option>
                    <option value="doctor">Doctor</option>
                    <option value="drugstore">Drugstore</option>
                    <option value="electrician">Electrician</option>
                    <option value="electronics_store">Electronics Store</option>
                    <option value="embassy">Embassy</option>
                    <option value="fire_station">Fire Station</option>
                    <option value="florist">Florist</option>
                    <option value="funeral_home">Funeral Home</option>
                    <option value="furniture_store">Furniture Store</option>
                    <option value="gas_station">Gas Station</option>
                    <option value="gym">Gym</option>
                    <option value="hair_care">Hair Care</option>
                    <option value="hardware_store">Hardware Store</option>
                    <option value="hindu_temple">Hindu Temple</option>
                    <option value="home_goods_store">Home Goods Store</option>
                    <option value="hospital">Hospital</option>
                    <option value="insurance_agency">Insurance Agency</option>
                    <option value="jewelry_store">Jewelry Store</option>
                    <option value="laundry">Laundry</option>
                    <option value="lawyer">Lawyer</option>
                    <option value="library">Library</option>
                    <option value="light_rail_station">Light Rail Station</option>
                    <option value="liquor_store">Liquor Store</option>
                    <option value="local_government_office">Local Government Office</option>
                    <option value="locksmith">Locksmith</option>
                    <option value="lodging">Lodging</option>
                    <option value="meal_delivery">Meal Delivery</option>
                    <option value="meal_takeaway">Meal Takeaway</option>
                    <option value="mosque">Mosque</option>
                    <option value="movie_rental">Movie Rental</option>
                    <option value="movie_theater">Movie Theater</option>
                    <option value="moving_company">Moving Company</option>
                    <option value="museum">Museum</option>
                    <option value="night_club">Night Club</option>
                    <option value="painter">Painter</option>
                    <option value="park">Park</option>
                    <option value="parking">Parking</option>
                    <option value="pet_store">Pet Store</option>
                    <option value="pharmacy">Pharmacy</option>
                    <option value="physiotherapist">Physiotherapist</option>
                    <option value="plumber">Plumber</option>
                    <option value="police">Police</option>
                    <option value="post_office">Post Office</option>
                    <option value="primary_school">Primary School</option>
                    <option value="real_estate_agency">Real Estate Agency</option>
                    <option value="restaurant">Restaurant</option>
                    <option value="roofing_contractor">Roofing Contractor</option>
                    <option value="rv_park">RV Park</option>
                    <option value="school">School</option>
                    <option value="secondary_school">Secondary School</option>
                    <option value="shoe_store">Shoe Store</option>
                    <option value="shopping_mall">Shopping Mall</option>
                    <option value="spa">Spa</option>
                    <option value="stadium">Stadium</option>
                    <option value="storage">Storage</option>
                    <option value="store">Store</option>
                    <option value="subway_station">Subway Station</option>
                    <option value="supermarket">Supermarket</option>
                    <option value="synagogue">Synagogue</option>
                    <option value="taxi_stand">Taxi Stand</option>
                    <option value="tourist_attraction">Tourist Attraction</option>
                    <option value="train_station">Train Station</option>
                    <option value="transit_station">Transit Station</option>
                    <option value="travel_agency">Travel Agency</option>
                    <option value="university">University</option>
                    <option value="veterinary_care">Veterinary Care</option>
                    <option value="zoo">Zoo</option>
                </select>
            </div>

            <button type="submit" class="submit-btn" id="submitBtn">
                <span id="btnText">üîç Find Places</span>
                <div class="loading" id="loading"></div>
            </button>
        </form>

        <div class="error" id="errorMsg"></div>

        <div class="results" id="results">
            <div class="results-header">
                <div class="results-title">Found Places</div>
                <div class="results-count" id="resultsCount">0</div>
            </div>
            <div class="poi-list" id="poiList"></div>
        </div>
    </div>

    <script>
        let currentLocationMode = 'coords';

        function toggleLocationInput(mode) {
            const coordsInput = document.getElementById('coordsInput');
            const cityInput = document.getElementById('cityInput');
            const toggleBtns = document.querySelectorAll('.toggle-btn');
            const latInput = document.getElementById('latitude');
            const lonInput = document.getElementById('longitude');
            const cityNameInput = document.getElementById('cityName');

            // Update button states
            toggleBtns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            currentLocationMode = mode;

            if (mode === 'coords') {
                coordsInput.style.display = 'block';
                cityInput.style.display = 'none';
                latInput.required = true;
                lonInput.required = true;
                cityNameInput.required = false;
            } else {
                coordsInput.style.display = 'none';
                cityInput.style.display = 'block';
                latInput.required = false;
                lonInput.required = false;
                cityNameInput.required = true;
            }
        }

        async function geocodeCity(cityName, apiKey) {
            const geocodeUrl = `https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(cityName)}&key=${apiKey}`;
            
            try {
                const response = await fetch(geocodeUrl);
                const data = await response.json();
                
                if (data.status === 'OK' && data.results.length > 0) {
                    const location = data.results[0].geometry.location;
                    return { lat: location.lat, lng: location.lng };
                } else {
                    throw new Error('City not found or geocoding failed');
                }
            } catch (error) {
                throw new Error(`Geocoding error: ${error.message}`);
            }
        }

        async function findPlaces(lat, lng, radius, type, apiKey) {
            const placesUrl = `https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=${lat},${lng}&radius=${radius}&type=${type}&key=${apiKey}`;
            
            try {
                // Note: Due to CORS restrictions, this would need to be handled through a proxy or backend
                // For demonstration, we'll simulate the API call
                const response = await fetch(`https://cors-anywhere.herokuapp.com/${placesUrl}`);
                const data = await response.json();
                
                if (data.status === 'OK') {
                    return data.results;
                } else {
                    throw new Error(`Places API error: ${data.status}`);
                }
            } catch (error) {
                // Since CORS will likely block this, we'll provide a fallback demo
                console.warn('CORS blocked or API error, using demo data');
                return generateDemoData(type, parseInt(radius));
            }
        }

        function generateDemoData(type, radius) {
            const demoPlaces = {
                restaurant: ['The Gourmet Bistro', 'Pizza Paradise', 'Sushi Master', 'Burger Junction', 'Cafe Delight'],
                gas_station: ['Shell Station', 'BP Fuel', 'Exxon Mobile', 'Chevron', 'Sunoco'],
                hospital: ['City General Hospital', 'Medical Center', 'Emergency Care', 'Health Clinic', 'Urgent Care'],
                pharmacy: ['CVS Pharmacy', 'Walgreens', 'Rite Aid', 'Local Pharmacy', 'MedPlus'],
                bank: ['Chase Bank', 'Bank of America', 'Wells Fargo', 'Citibank', 'Local Credit Union'],
                atm: ['Chase ATM', 'Bank of America ATM', 'Wells Fargo ATM', 'Citibank ATM', '7-Eleven ATM'],
                airport: ['International Airport', 'Regional Airport', 'Private Airfield', 'Heliport', 'Air Base'],
                school: ['Elementary School', 'Middle School', 'High School', 'Private Academy', 'Charter School'],
                university: ['State University', 'Community College', 'Technical Institute', 'Private University', 'Graduate School'],
                museum: ['Art Museum', 'Science Museum', 'History Museum', 'Natural History Museum', 'Children\'s Museum'],
                park: ['Central Park', 'Community Park', 'Dog Park', 'Playground', 'Nature Reserve'],
                shopping_mall: ['Town Center Mall', 'Outlet Mall', 'Shopping Plaza', 'Strip Mall', 'Department Store'],
                cafe: ['Coffee House', 'Espresso Bar', 'Internet Cafe', 'Bakery Cafe', 'Bistro Cafe'],
                gym: ['Fitness Center', 'CrossFit Gym', 'Yoga Studio', 'Boxing Gym', 'Planet Fitness'],
                library: ['Public Library', 'University Library', 'Branch Library', 'Digital Library', 'Community Library']
            };

            const places = demoPlaces[type] || [`Sample ${type.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase())} 1`, `Sample ${type.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase())} 2`, `Sample ${type.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase())} 3`];
            
            return places.map((name, index) => ({
                name: name,
                vicinity: `${Math.floor(Math.random() * 999) + 100} Main Street, City`,
                rating: (Math.random() * 2 + 3).toFixed(1),
                geometry: {
                    location: {
                        lat: 40.7128 + (Math.random() - 0.5) * 0.01,
                        lng: -74.0060 + (Math.random() - 0.5) * 0.01
                    }
                },
                place_id: `demo_${type}_${index}`
            }));
        }

        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371e3; // Earth's radius in meters
            const œÜ1 = lat1 * Math.PI/180;
            const œÜ2 = lat2 * Math.PI/180;
            const ŒîœÜ = (lat2-lat1) * Math.PI/180;
            const ŒîŒª = (lon2-lon1) * Math.PI/180;

            const a = Math.sin(ŒîœÜ/2) * Math.sin(ŒîœÜ/2) +
                      Math.cos(œÜ1) * Math.cos(œÜ2) *
                      Math.sin(ŒîŒª/2) * Math.sin(ŒîŒª/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));

            return Math.round(R * c);
        }

        function displayResults(places, centerLat, centerLng) {
            const resultsDiv = document.getElementById('results');
            const poiList = document.getElementById('poiList');
            const resultsCount = document.getElementById('resultsCount');

            resultsCount.textContent = places.length;
            poiList.innerHTML = '';

            places.forEach(place => {
                const distance = calculateDistance(
                    centerLat, centerLng,
                    place.geometry.location.lat, place.geometry.location.lng
                );

                const poiItem = document.createElement('div');
                poiItem.className = 'poi-item';
                poiItem.innerHTML = `
                    <div class="poi-name">${place.name}</div>
                    <div class="poi-address">${place.vicinity}</div>
                    <div class="poi-details">
                        <div class="poi-rating">
                            ${place.rating ? `‚≠ê ${place.rating}` : 'No rating'}
                        </div>
                        <div class="poi-distance">${distance}m away</div>
                    </div>
                `;
                poiList.appendChild(poiItem);
            });

            resultsDiv.style.display = 'block';
        }

        function showError(message) {
            const errorDiv = document.getElementById('errorMsg');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        function setLoading(isLoading) {
            const submitBtn = document.getElementById('submitBtn');
            const btnText = document.getElementById('btnText');
            const loading = document.getElementById('loading');

            if (isLoading) {
                submitBtn.disabled = true;
                btnText.style.display = 'none';
                loading.style.display = 'block';
            } else {
                submitBtn.disabled = false;
                btnText.style.display = 'block';
                loading.style.display = 'none';
            }
        }

        document.getElementById('geocoderForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const apiKey = document.getElementById('apiKey').value;
            const radius = document.getElementById('radius').value;
            const category = document.getElementById('category').value;
            
            let lat, lng;

            setLoading(true);
            document.getElementById('results').style.display = 'none';

            try {
                if (currentLocationMode === 'coords') {
                    lat = parseFloat(document.getElementById('latitude').value);
                    lng = parseFloat(document.getElementById('longitude').value);
                } else {
                    const cityName = document.getElementById('cityName').value;
                    const coords = await geocodeCity(cityName, apiKey);
                    lat = coords.lat;
                    lng = coords.lng;
                }

                const places = await findPlaces(lat, lng, radius, category, apiKey);
                displayResults(places, lat, lng);

            } catch (error) {
                showError(error.message);
            } finally {
                setLoading(false);
            }
        });

        // Add some sample data on load
        window.addEventListener('load', () => {
            document.getElementById('latitude').value = '40.712776';
            document.getElementById('longitude').value = '-74.005974';
        });
    </script>
</body>
</html>
